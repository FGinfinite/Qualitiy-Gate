# 项目任务进度

本项目遵循 `docs/项目任务.md` 中定义的5个核心任务。

- [x] **任务 1：项目框架原则与环境搭建**
- [x] **任务 2：实现阶段一 - 选择模型预热**
- [x] **任务 3：实现阶段二 - 数据选择**
- [x] **任务 4：实现阶段三 - 目标模型训练**
- [ ] **任务 5：实现阶段四 - 模型评估**

---
## 其他已完成任务
- [x] **创建权重对比脚本**
  - **成果**: 创建了 `scripts/compare_router_weights.py` 脚本，用于验证和分析阶段一训练后 `router` 权重的变化。
  - **关键决策**: 为了简化模型加载和分析流程，将分布式训练策略从 FSDP 切换到了 DDP。
- [x] **分析Stage 1数据处理流程**
  - **成果**: 明确了第一阶段预训练的数据来源、缓存机制和详细处理步骤。
  - **知识归档**: 分析结论已整合进 `decisionLog.md`。
- [x] **修复Stage 1数据处理错误**
  - **成果**: 解决了因数据集格式不统一导致的 `KeyError: 'text'` 错误，并增加了代码的健壮性以处理潜在的 `None` 值。
  - **知识归档**: 详细的修复过程记录在 `decisionLog.md` 中。
---
### 任务：检查FP8训练支持 (2025-06-14)

*   **任务**: 确认当前脚本是否支持 `Qwen/Qwen3-30B-A3B-FP8` 模型的FP8训练。
*   **状态**: 已完成。
*   **执行者**: `code` 模式子任务。
*   **发现**: 脚本目前不支持FP8训练。原因是 [`src/stages/pretrain.py`](src/stages/pretrain.py) 文件中硬编码了 `torch.bfloat16` 数据类型，这阻止了FP8模型的加载和训练。